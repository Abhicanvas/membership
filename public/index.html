<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>IEEE Club Membership Form</title>
  <style>
    * { box-sizing: border-box; margin:0; padding:0; }
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #121212; color: #e4e4e7; min-height: 100vh; padding: 20px; }
    .container { max-width: 700px; margin: auto; background: #1e1e1e; border-radius: 16px; overflow: hidden; box-shadow: 0 20px 40px rgba(0,0,0,0.5); }
    .header { background: linear-gradient(135deg, #3b82f6, #1d4ed8); padding: 32px; text-align: center; color: white; }
    .header h2 { font-size: 2rem; margin-bottom: 8px; }
    .header p { font-size: 1rem; }
    form { padding: 32px; }
    .form-group { margin-bottom: 20px; }
    label { display: block; margin-bottom: 8px; font-weight: 600; font-size: 0.95rem; }
    input, select { width: 100%; padding: 12px 14px; background: #27272a; border: 2px solid #3f3f46; border-radius: 8px; color: #e4e4e7; font-size: 1rem; transition: all 0.3s; }
    input:focus, select:focus { outline: none; border-color: #3b82f6; background: #2d2d30; box-shadow: 0 0 0 4px rgba(59,130,246,0.1); }
    select option { background: #1a1a1a; color: #e4e4e7; }
    .section { background: #1a1a1a; border: 1px solid #2d2d30; border-radius: 12px; padding: 20px; margin-bottom: 24px; }
    .section-title { font-size: 1.1rem; font-weight: 700; color: #f4f4f5; margin-bottom: 16px; }
    .radio-group, .checkbox-group { display: grid; gap: 12px; margin-top: 12px; }
    .radio-group label, .checkbox-group label { display: flex; align-items: center; gap: 12px; padding: 12px; background: #27272a; border: 1px solid #3f3f46; border-radius: 8px; cursor: pointer; font-weight: 400; }
    .radio-group input, .checkbox-group input { width: auto; accent-color: #3b82f6; }
    .fee-box { background: linear-gradient(135deg,#1e3a8a,#1d4ed8); border-radius: 12px; padding: 24px; margin: 24px 0; text-align: center; color: #fff; }
    .fee-box #grandTotal { font-size: 1.5rem; font-weight: 700; color: #fbbf24; }
    .qr-section { background: #1a1a1a; border-radius: 12px; padding: 24px; text-align: center; margin: 24px 0; border: 1px solid #2d2d30; }
    .qr-section img { max-width: 200px; border-radius: 12px; box-shadow: 0 8px 25px rgba(0,0,0,0.3); }
    input[type="file"] { padding: 12px; background: #1a1a1a; border: 2px dashed #3f3f46; color: #a1a1aa; }
    button { width: 100%; padding: 16px; background: linear-gradient(135deg,#3b82f6,#1d4ed8); color:white; border:none; border-radius:12px; font-size:1.1rem; font-weight:600; cursor:pointer; transition: all 0.3s; }
    button:hover { background: linear-gradient(135deg,#2563eb,#1e40af); transform: translateY(-2px); }
    /* Toast styles */
    .toast { position: fixed; top: 20px; right: 20px; background: linear-gradient(135deg, #22c55e,#16a34a); color:#fff; padding:16px 24px; border-radius:12px; font-weight:600; box-shadow:0 8px 25px rgba(0,0,0,0.2); opacity:0; transform: translateY(-50px); pointer-events:none; transition: all 0.4s ease; z-index:9999; min-width:250px; text-align:center; }
    .toast.show { opacity:1; transform: translateY(0); pointer-events:auto; }
    .toast.error { background: linear-gradient(135deg,#ef4444,#b91c1c); }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h2>IEEE Membership Registration</h2>
      <p>Join the world's largest technical professional organization</p>
    </div>

    <form id="membershipForm" enctype="multipart/form-data">
      <div class="form-group">
        <label>First Name</label>
        <input type="text" name="firstName" required>
      </div>
      <div class="form-group">
        <label>Last Name</label>
        <input type="text" name="lastName" required>
      </div>
      <div class="form-group">
        <label>Email ID</label>
        <input type="email" name="email" required>
      </div>
      <div class="form-group">
        <label>Contact Number</label>
        <input type="text" name="contact" required>
      </div>
      <div class="form-group">
        <label>IEEE Membership ID</label>
        <input type="text" name="ieeeId">
      </div>
      <div class="form-group">
        <label>Membership Type</label>
        <select name="membershipType" required>
          <option value="">--Select--</option>
          <option value="New">New</option>
          <option value="Renewal">Renewal</option>
        </select>
      </div>
      <div class="form-group">
        <label>Current Account Password (for Renewals)</label>
        <input type="password" name="renewalPassword">
      </div>
      <div class="form-group">
        <label>Branch</label>
        <select name="branch" required>
          <option value="">--Select Branch--</option>
          <option value="CSE">Computer Science Engineering</option>
          <option value="ECE">Electronics & Communication Engineering</option>
          <option value="EEE">Electrical & Electronics Engineering</option>
          <option value="ME">Mechanical Engineering</option>
          <option value="CE">Civil Engineering</option>
          <option value="AI">Artificial Intelligence</option>
        </select>
      </div>
      <div class="form-group">
        <label>Batch</label>
        <select name="batch" required>
          <option value="">--Select Batch--</option>
          <option value="A">Batch A</option>
          <option value="B">Batch B</option>
          <option value="C">Batch C</option>
          <option value="D">Batch D</option>
        </select>
      </div>
      <div class="form-group">
        <label>Year</label>
        <select name="year" required>
          <option value="">--Select Year--</option>
          <option value="1st Year">1st Year</option>
          <option value="2nd Year">2nd Year</option>
          <option value="3rd Year">3rd Year</option>
          <option value="4th Year">4th Year</option>
        </select>
      </div>

      <div class="section">
        <div class="section-title">Choose Societies</div>
        <div class="checkbox-group">
          <label><input type="checkbox" name="societies" value="Computer Society"> Computer Society (‚Çπ750 + 210)</label>
          <label><input type="checkbox" name="societies" value="Robotics and Automation Society"> Robotics and Automation Society (‚Çπ750 + 265)</label>
          <label><input type="checkbox" name="societies" value="Communication Society"> Communication Society (‚Çπ750 + 35)</label>
          <label><input type="checkbox" name="societies" value="Power and Energy Society"> Power and Energy Society (‚Çπ750 + 35)</label>
          <label><input type="checkbox" name="societies" value="Signal Processing Society"> Signal Processing Society (‚Çπ750 + 35)</label>
          <label><input type="checkbox" name="societies" value="Women in Engineering"> Women in Engineering (‚Çπ750)</label>
          <label><input type="checkbox" name="societies" value="SIGHT"> SIGHT (‚Çπ750)</label>
          <label><input type="checkbox" name="societies" value="Education Society"> Education Society (‚Çπ750 + 55)</label>
        </div>
      </div>

      <div class="fee-box">
        <p id="societiesFee">Societies Fee: ‚Çπ0</p>
        <p id="grandTotal"><b>Total: ‚Çπ0</b></p>
      </div>

      <div class="qr-section">
        <p><b>Pay using GPay QR Code</b></p>
        <img src="qr.png" alt="GPay QR Code">
      </div>

      <div class="form-group">
        <label>Upload Payment Screenshot</label>
        <input type="file" name="screenshot" accept="image/*">
      </div>

      <button type="submit">Submit Registration</button>
    </form>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast"></div>

  <script>
    const form = document.getElementById("membershipForm");
    const societyBoxes = document.querySelectorAll("input[name='societies']");
    const societiesFee = document.getElementById("societiesFee");
    const grandTotal = document.getElementById("grandTotal");
    const toast = document.getElementById("toast");

    function calculateTotal() {
      let total = 0;
      societyBoxes.forEach(cb => {
        if (cb.checked) {
          if (cb.value === "Computer Society") total += 750 + 210;
          else if (cb.value === "Robotics and Automation Society") total += 750 + 265;
          else if (cb.value === "Communication Society") total += 750 + 35;
          else if (cb.value === "Power and Energy Society") total += 750 + 35;
          else if (cb.value === "Signal Processing Society") total += 750 + 35;
          else if (cb.value === "Women in Engineering") total += 750;
          else if (cb.value === "SIGHT") total += 750;
          else if (cb.value === "Education Society") total += 750 + 55;
        }
      });
      societiesFee.textContent = "Societies Fee: ‚Çπ" + total;
      grandTotal.innerHTML = "<b>Total: ‚Çπ" + total + "</b>";
    }

    function showToast(message, type="success") {
      toast.textContent = message;
      toast.className = `toast show ${type==="error"?"error":""}`;
      setTimeout(() => toast.className = "toast", 3000);
    }

    societyBoxes.forEach(cb => cb.addEventListener("change", calculateTotal));

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      calculateTotal();

      let formData = new FormData(form);
      const totalText = grandTotal.textContent;
      const totalValue = totalText.replace(/[^0-9]/g, "");
      formData.append("totalFee", totalValue);
      formData.append("submittedAt", new Date().toISOString());

      try {
        let res = await fetch("/api/register", {
          method: "POST",
          body: formData
        });
        let result = await res.json();
        if (result.success) {
          showToast("üéâ Registration submitted successfully!");
          form.reset();
          calculateTotal();
        } else {
          showToast("‚ö†Ô∏è Error submitting registration", "error");
        }
      } catch(err) {
        showToast("‚ö†Ô∏è Network error", "error");
        console.error(err);
      }
    });

    calculateTotal();
  </script>
</body>
</html>
